Du bist AI-3 (QA/Release Cell) auf Branch `feature/v1-ux-aiB`.

Lies zuerst:
- `handoffs/HANDOFF_20260216_core_to_ai3_w4.md`
- `handoffs/HANDOFF_20260216_core_to_ai3_w3.md`
- `handoffs/HANDOFF_20260216_ai3_w2.md`

## Harte Regeln
1. Keine Edits in:
- `modeling/**`
- `gui/main_window.py`
- `gui/viewport_pyvista.py`

2. Fokusbereiche:
- `scripts/**`
- `roadmap_ctp/**`
- `test/**` (nur QA/Gate-nahe Tests)
- optional `.github/workflows/**`

3. Keine Placeholder-Texte, keine "sollte"-Aussagen ohne Repro-Command.
4. Jede Behauptung in Reports muss durch einen in der Datei aufgeführten Command belegbar sein.

## Ziel
QA/Gates auf release-harten Stand bringen: reproduzierbar, robust, evidenzbasiert.

## Arbeitspakete (Pflicht, Reihenfolge bindend)

### WP1 (P0): Runner-Hardening und Exit-Code-Vertrag
#### Aufgabe
Härten und vereinheitlichen:
- `scripts/gate_core.ps1`
- `scripts/gate_ui.ps1`
- `scripts/gate_all.ps1`
- `scripts/hygiene_check.ps1`

#### Mindestanforderungen
1. `gate_ui.ps1` muss auch bei fehlgeschlagenem `conda run` seine eigene Result-Summary ausgeben.
2. `gate_ui.ps1` muss klar unterscheiden:
- `BLOCKED` (Infrastructure errors)
- `FAIL` (logische Test-Fails)
3. `gate_all.ps1` muss Hygiene-Policy explizit steuern:
- Parameter `-StrictHygiene` (default: false)
- Bei `-StrictHygiene`: Hygiene-Verstöße => Gesamt-Exit=1
4. Alle Runner geben einheitliches Format aus:
- Dauer
- pass/fail/skip/error counts
- Status
- Exit Code

#### Abnahme
- Runner-Kommandos laufen reproduzierbar und liefern konsistente Ausgabe.

---

### WP2 (P0): QA-Dokumente auf aktuellen Core-Stand rebasen
#### Update verpflichtend
- `roadmap_ctp/FLAKY_BURN_DOWN_20260215.md`
- `roadmap_ctp/GATE_DEFINITIONS_20260215.md`
- `roadmap_ctp/REGRESSION_PACK_STATUS_20260215.md`
- `roadmap_ctp/ERROR_CODE_MAPPING_QA_20260215.md`
- `roadmap_ctp/WORKSPACE_HYGIENE_GATE_20260215.md`

#### Inhaltliche Pflichtpunkte
1. Core-Gate-Stand auf aktuellen Wert bringen (`238 passed, 2 skipped`, sofern reproduziert).
2. Regression-Pack-Zahlen aktualisieren (`99 passed, 1 skipped` + PI-010-Suite separat `20 passed`).
3. Veraltete W2-Zahlen bereinigen.
4. `tnp_ref_drift` als echten operationalisierten Warning-Pfad dokumentieren.
5. UI-Blocker weiter mit exakter Quelle führen:
- `NameError: tr not defined`
- `gui/widgets/status_bar.py:126`

---

### WP3 (P0): Konsolidierte Evidence-Datei erstellen
#### Neu erstellen
- `roadmap_ctp/QA_EVIDENCE_W4_20260216.md`
- optional: `roadmap_ctp/QA_EVIDENCE_W4_20260216.json`

#### Muss enthalten
1. Exakte Kommandos
2. Exakte Resultate
3. Datum/Uhrzeit
4. Branch
5. Toolchain-Info (python/pytest)
6. Offene Blocker (klar getrennt in Infra vs Logik)

---

### WP4 (P1): Hygiene-Gate Operationalisierung
#### Aufgabe
1. `hygiene_check.ps1` muss sauber zwischen WARN und FAIL konfigurierbar sein.
2. Report mit Violations + Fix-Empfehlung + Owner ergänzen.
3. `.gitignore`-Vorschläge in Doku konsistent machen.

#### Optional
- kleine Cleanup-Liste in `roadmap_ctp/` mit Candidate-Dateien und Entscheidung (keep/delete/move).

---

### WP5 (P1): Error-Code Mapping QA vertiefen
#### Aufgabe
Update `roadmap_ctp/ERROR_CODE_MAPPING_QA_20260215.md`:
- `tnp_ref_missing`
- `tnp_ref_mismatch`
- `tnp_ref_drift`
- `rebuild_finalize_failed`
- `ocp_api_unavailable`

#### Pflicht
- Für jeden Code: Core-Evidence + UI-Mapping-Evidence + Gap-Status.
- Keine pauschalen Aussagen ohne Test-/Codebezug.

---

### WP6 (P2, optional): CI-Gate-Skeleton
Falls Zeit:
- `.github/workflows/gates.yml` Entwurf
- Stages: core-gate, ui-gate, hygiene-gate
- `continue-on-error` nur begründet

## Pflicht-Validierung (vollständig ausführen)
```powershell
conda run -n cad_env python -m pytest -q test/test_parametric_reference_modelset.py
conda run -n cad_env python -m pytest -q test/test_feature_error_status.py test/test_tnp_v4_feature_refs.py test/test_trust_gate_core_workflow.py test/test_cad_workflow_trust.py test/test_brepopengun_offset_api.py test/test_feature_flags.py test/test_tnp_stability.py test/test_feature_edit_robustness.py test/test_project_roundtrip_persistence.py test/test_parametric_reference_modelset.py
conda run -n cad_env python -m pytest -q test/test_ui_abort_logic.py test/harness/test_interaction_consistency.py
powershell -ExecutionPolicy Bypass -File scripts/gate_core.ps1
powershell -ExecutionPolicy Bypass -File scripts/gate_ui.ps1
powershell -ExecutionPolicy Bypass -File scripts/gate_all.ps1
powershell -ExecutionPolicy Bypass -File scripts/gate_all.ps1 -StrictHygiene
powershell -ExecutionPolicy Bypass -File scripts/hygiene_check.ps1
powershell -ExecutionPolicy Bypass -File scripts/hygiene_check.ps1 -FailOnUntracked
```

## Rückgabeformat (Pflicht)
Datei: `handoffs/HANDOFF_20260216_ai3_w4.md`

Struktur:
1. Problem
2. API/Behavior Contract
3. Impact
4. Validation
5. Breaking Changes / Residual Risks

Zusatzpflicht:
- Liste der geänderten Dateien
- Für jede Datei: 1 Satz "warum geändert"
- Nächste 5 priorisierte Folgeaufgaben mit Owner+ETA
