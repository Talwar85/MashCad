# HANDOFF_20260216_ai3_w2

**Date:** 2026-02-16  
**From:** AI-3 (QA/Release Cell)  
**To:** Codex (Core), Gemini (UX)  
**ID:** ai3_w2  
**Branch:** `feature/v1-ux-aiB`

---

## 1. Problem

AI-3 W1 Report war teilweise veraltet. Core-Rollback-Metriken-Blocker (fillet/hole) sind in Core gefixt, aber W1-Dokumente markierten sie noch als offen.

Aktuelles Release-Risiko:
- UI-Gate bleibt blockiert durch `NameError: tr not defined` in `gui/widgets/status_bar.py:126`
- QA-Dokumente und Gate-Definitionen brauchen Rebaseline auf aktuelle Fakten
- Workspace-Hygiene ist weiterhin schwach (Debug/Temp-Dateien noch vorhanden)

---

## 2. API/Behavior Contract

### Keine API-√Ñnderungen
Dieser QA-Durchlauf hat keine neuen APIs oder Behavior Contracts eingef√ºhrt.

### AI-3 Scope
- **Allowed:** `test/**`, `roadmap_ctp/**`, `scripts/**` (gate tooling)
- **Blocked:** `modeling/**`, `gui/main_window.py`, `gui/viewport_pyvista.py`

### Neue Gate-Runner-Skripte
| Skript | Zweck | Exit Code |
|--------|-------|-----------|
| `scripts/gate_core.ps1` | Core-Gate Runner | 0=PASS, 1=FAIL |
| `scripts/gate_ui.ps1` | UI-Gate Runner | 0=PASS, 1=FAIL/BLOCKED |
| `scripts/gate_all.ps1` | Aggregator (Core+UI+Hygiene) | 0=ALL PASS, 1=ANY FAIL |
| `scripts/hygiene_check.ps1` | Workspace-Hygiene Check | 0=CLEAN, 1=VIOLATIONS (if -FailOnUntracked) |

---

## 3. Impact

### Core Baseline (W2)
**Validiert durch AI-3:**
- Core-gate pack: `217 passed, 2 skipped`
- Regression pack (4 suites): `98 passed, 1 skipped`

### UI Baseline (W2)
**Validiert durch AI-3:**
- `11 errors, 3 skipped` (blockiert bei MainWindow Setup weil `tr` nicht definiert)

### Erstellte/Updated Artefakte
| Artefakt | Pfad | Status |
|----------|------|--------|
| Flaky Burn-Down Matrix | `roadmap_ctp/FLAKY_BURN_DOWN_20260215.md` | üîÑ Updated |
| Gate-Definitionen | `roadmap_ctp/GATE_DEFINITIONS_20260215.md` | üîÑ Updated |
| Regression-Pack Status | `roadmap_ctp/REGRESSION_PACK_STATUS_20260215.md` | üîÑ Updated |
| Error-Code QA Report | `roadmap_ctp/ERROR_CODE_MAPPING_QA_20260215.md` | üîÑ Updated |
| Workspace-Hygiene Gate | `roadmap_ctp/WORKSPACE_HYGIENE_GATE_20260215.md` | üîÑ Updated |
| Core-Gate Runner | `scripts/gate_core.ps1` | ‚úÖ NEW |
| UI-Gate Runner | `scripts/gate_ui.ps1` | ‚úÖ NEW |
| All-Gate Aggregator | `scripts/gate_all.ps1` | ‚úÖ NEW |
| Hygiene-Check | `scripts/hygiene_check.ps1` | ‚úÖ NEW |

---

## 4. Validation

### Core-Gate (W2)
```powershell
conda run -n cad_env python -m pytest -q `
    test/test_feature_error_status.py `
    test/test_tnp_v4_feature_refs.py `
    test/test_trust_gate_core_workflow.py `
    test/test_cad_workflow_trust.py `
    test/test_brepopengun_offset_api.py `
    test/test_feature_flags.py `
    test/test_tnp_stability.py `
    test/test_feature_edit_robustness.py `
    test/test_project_roundtrip_persistence.py
```

**Resultat:** `217 passed, 2 skipped` ‚úÖ

**Runner-Validierung:**
```powershell
powershell -ExecutionPolicy Bypass -File scripts/gate_core.ps1
# Erwartet: Status: ‚úÖ PASS, Exit Code: 0
```

---

### UI-Gate (W2)
```powershell
conda run -n cad_env python -m pytest -q `
    test/test_ui_abort_logic.py `
    test/harness/test_interaction_consistency.py
```

**Resultat:** `3 skipped, 11 errors` üî¥

**Root Blocker:**
```
NameError: name 'tr' is not defined
Location: gui/widgets/status_bar.py:126
```

**Runner-Validierung:**
```powershell
powershell -ExecutionPolicy Bypass -File scripts/gate_ui.ps1
# Erwartet: Status: BLOCKED, Exit Code: 1
```

---

### Regression-Pack (W2)
```powershell
conda run -n cad_env python -m pytest -q `
    test/test_feature_error_status.py `
    test/test_tnp_v4_feature_refs.py `
    test/test_project_roundtrip_persistence.py `
    test/test_feature_edit_robustness.py
```

**Resultat:** `98 passed, 1 skipped` ‚úÖ

| Suite | Resultat |
|-------|----------|
| `test_feature_error_status.py` | 10 passed |
| `test_tnp_v4_feature_refs.py` | 36 passed, 1 skipped |
| `test_project_roundtrip_persistence.py` | 10 passed |
| `test_feature_edit_robustness.py` | 6 passed |

---

### Hygiene-Gate (W2)
```powershell
powershell -ExecutionPolicy Bypass -File scripts/hygiene_check.ps1
```

**Resultat:** ‚ö†Ô∏è 7 Violations

| Datei | Typ |
|-------|-----|
| `test/debug_mainwindow.py` | Debug-Skript |
| `test/debug_qtbot.py` | Debug-Skript |
| `test/test_debug_extrude.py` | Temp-Test |
| `test/test_debug_profiles.py` | Temp-Test |
| `test/_debug_revolve.py` | Temp-Test |
| `test_output.txt` | Test-Output |
| `test_output_trace.txt` | Test-Output |

---

### Error-Code Mapping (W2 Evidence-Based)
| Code | Core | GUI | Status |
|------|------|-----|--------|
| `tnp_ref_missing` | ‚úÖ | ‚úÖ | COVERED |
| `tnp_ref_mismatch` | ‚úÖ | ‚úÖ | COVERED |
| `tnp_ref_drift` | ‚úÖ | ‚ö†Ô∏è | GAP (keine User-Notification) |
| `rebuild_finalize_failed` | ‚úÖ | ‚úÖ | COVERED |
| `ocp_api_unavailable` | ‚úÖ | ‚úÖ | COVERED |

---

## 5. Breaking Changes / Residual Risks

### Breaking Changes
- **Keine** - Nur Dokumentation und Runner-Skripte

### Residual Risks
| Risiko | Wahrscheinlichkeit | Impact | Mitigation |
|--------|-------------------|--------|------------|
| UI-Gate bleibt l√§nger blockiert | Hoch | Keine UI-Regression-Validierung | Gemini-Priorisierung f√ºr `tr()` Fix |
| Hygiene-Violations akkumulieren | Mittel | Repository-Bloat | Skripte jetzt verf√ºgbar, CI-Integration empfohlen |
| `tnp_ref_drift` UX-L√ºcke bleibt | Niedrig | Stille Datenmigration | P2-Ticket |

---

## N√§chste 3 Priorisierte Folgeaufgaben

### 1. P0: UI-Gate Infrastructure Unblock (Gemini)
**Aufgaben:**
- Fix: `from i18n import tr` in `gui/widgets/status_bar.py` hinzuf√ºgen (Z. 126)
- Fix: `eventFilter` in `gui/viewport_pyvista.py` konsolidieren (doppelte Definition)

**Validierung:**
```powershell
conda run -n cad_env python -m pytest test/test_ui_abort_logic.py -x
# Erwartet: Keine Errors (Ergebnis irrelevant, nur keine Infrastructure-Fehler)
```

**Owner:** Gemini (UX)  
**ETA:** ASAP

---

### 2. P1: Workspace-Hygiene Cleanup (AI-3)
**Aufgaben:**
- `.gitignore` erweitern um `test_output*.txt`
- Debug-Dateien in `test/` reviewen und bereinigen oder nach `scripts/debug/` verschieben
- `test_output*.txt` l√∂schen

**Validierung:**
```powershell
powershell -ExecutionPolicy Bypass -File scripts/hygiene_check.ps1
# Erwartet: Status: ‚úÖ CLEAN
```

**Owner:** AI-3 (QA)  
**ETA:** 2026-02-17

---

### 3. P1: Gate-Runner CI-Integration (AI-3)
**Aufgaben:**
- GitHub Actions Workflow erstellen mit Core-Gate + Hygiene-Gate
- Badge im README f√ºr Gate-Status

**Validierung:**
```yaml
# .github/workflows/gates.yml
- name: Core-Gate
  run: powershell -ExecutionPolicy Bypass -File scripts/gate_core.ps1
- name: Hygiene-Gate
  run: powershell -ExecutionPolicy Bypass -File scripts/hygiene_check.ps1 -FailOnUntracked
  continue-on-error: true
```

**Owner:** AI-3 (QA)  
**ETA:** 2026-02-18

---

## Referenz-Dokumente

Alle Artefakte befinden sich in:
- `roadmap_ctp/FLAKY_BURN_DOWN_20260215.md`
- `roadmap_ctp/GATE_DEFINITIONS_20260215.md`
- `roadmap_ctp/REGRESSION_PACK_STATUS_20260215.md`
- `roadmap_ctp/ERROR_CODE_MAPPING_QA_20260215.md`
- `roadmap_ctp/WORKSPACE_HYGIENE_GATE_20260215.md`
- `scripts/gate_core.ps1`
- `scripts/gate_ui.ps1`
- `scripts/gate_all.ps1`
- `scripts/hygiene_check.ps1`

---

**End of Handoff AI-3 W2**
